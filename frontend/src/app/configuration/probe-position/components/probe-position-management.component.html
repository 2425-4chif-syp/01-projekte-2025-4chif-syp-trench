<div class="probe-position-container">
  @if (this.probePositionService.groupedProbePositions && this.probePositionService.groupedProbePositions.length > 0) {
    @for (group of this.probePositionService.groupedProbePositions; track $index) {
      <div class="position-card">
        <div class="card-header">
          Joch {{ $index + 1 }}
        </div>
        <div class="card-body">
          <div class="table-wrapper">
            <table class="table table-hover mb-0 text-center">
              <thead>
                <tr>
                  <th>Position</th>
                  <th>Sonde</th>
                  <th>Aktionen</th>
                </tr>
              </thead>
              <tbody>
                @for (probePosition of this.probePositionService.groupedProbePositions[$index]; track $index) {
                  <tr>
                    <td>{{probePosition.position}}</td>
                    <td>{{ probePosition.measurementProbe?.name || 'keine' }}</td>
                    <td>
                      <div class="action-buttons">
                        <button class="btn btn-primary btn-sm" (click)="openProbeSelector(probePosition)"
                          [attr.aria-label]="probePosition.measurementProbe ? 'Sonde bearbeiten' : 'Sonde hinzufügen'"
                          title="{{ probePosition.measurementProbe ? 'Bearbeiten' : 'Hinzufügen' }}">
                          @if (probePosition.measurementProbe == null) {
                            <img src="/assets/plus.svg" alt="" class="icon" />
                          } @else {
                            <img src="/assets/pencil.svg" alt="" class="icon" />
                          }
                        </button>

                        <button class="btn btn-danger btn-sm ms-1" [disabled]="probePosition.measurementProbe == null"
                          (click)="deleteProbePosition(probePosition)" aria-label="Sonde entfernen" title="Löschen">
                          <img src="/assets/trash.svg" alt="" class="icon" />
                        </button>
                      </div>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      </div>
    }
  } @else {
    <div class="empty-state">
      <p>Keine Sondenpositionen vorhanden. Bitte speichern Sie zuerst die Messeinstellung.</p>
    </div>
  }
</div>